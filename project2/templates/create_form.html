<style>
  .file-input-card {
    background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
    border: 2px dashed #6a11cb;
    padding: 2rem;
    text-align: center;
    cursor: pointer;
    transition: transform 0.2s ease, background-color 0.2s ease;
  }
  .file-input-card:hover {
    transform: scale(1.02);
    background: linear-gradient(135deg, #c3cfe2, #f5f7fa);
  }
  .form-control-lg {
    height: 60px;
    font-size: 1.2rem;
  }
  .question-type-grid .btn {
    background: linear-gradient(135deg, #6a11cb, #2575fc);
    color: white;
    border: none;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .question-type-grid .btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }
  .collapse:not(.show) {
    display: block;
    height: 0;
    overflow: hidden;
    transition: height 0.5s ease;
  }
  .collapse.show {
    height: auto;
    transition: height 0.5s ease;
  }
</style>

<!-- ë³¸ë¬¸ ë‚´ìš© -->
<h2 class="mb-4">ğŸ“„ íŒŒì¼ë¡œ ë¬¸ì œ ìƒì„±í•˜ê¸°</h2>

<form action="{{ url_for('generate') }}" method="POST" enctype="multipart/form-data" class="loading-form" onsubmit="showLoading()">
  <div class="file-input-card mb-4">
    <div class="mb-3">
      <h3 class="mb-3">íŒŒì¼ ì„ íƒ</h3>
      <label for="file" class="form-label fs-5">PDF, PNG, JPG íŒŒì¼ ì—…ë¡œë“œ</label>
      <input
        type="file"
        class="form-control form-control-lg"
        id="file"
        name="file"
        required
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="PDF, PNG, JPG íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.">
    </div>
  </div>

  <div class="text-center mb-3">
    <button
      class="btn btn-secondary"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#detailSection"
      aria-expanded="false"
      aria-controls="detailSection">
      ìƒì„¸ ì‚¬í•­
    </button>
  </div>

  <div class="collapse" id="detailSection">
    <div class="card card-body mb-4">
      <h4 class="mb-3">ìƒì„¸ ì‚¬í•­</h4>

      <div class="mb-3">
        <label for="title" class="form-label">ë¬¸ì œ ì„¸íŠ¸ ì œëª©</label>
        <input
          type="text"
          class="form-control"
          id="title"
          name="title"
          placeholder="ì˜ˆ: 2023ë…„ 2í•™ê¸° ì¤‘ê°„ê³ ì‚¬">
      </div>

      <div class="row g-3 mb-3">
        <div class="col-md-6">
          <label for="total_questions" class="form-label">ë¬¸ì œ ìˆ˜</label>
          <input
            type="number"
            class="form-control"
            id="total_questions"
            name="total_questions"
            value="9"
            required>
        </div>
        <div class="col-md-6">
          <label for="difficulty" class="form-label">ë‚œì´ë„</label>
          <select class="form-select" id="difficulty" name="difficulty">
            <option value="ì‰¬ì›€">ì‰¬ì›€</option>
            <option value="ë³´í†µ" selected>ë³´í†µ</option>
            <option value="ì–´ë ¤ì›€">ì–´ë ¤ì›€</option>
          </select>
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label">ë¬¸ì œ ìœ í˜• ì„ íƒ</label>
        <div class="row g-2 question-type-grid">
          {% for qtype in available_types %}
            <div class="col-6 col-md-3">
              <input
                type="checkbox"
                class="btn-check"
                id="qtype_{{ loop.index }}"
                name="question_types"
                value="{{ qtype }}"
                checked>
              <label class="btn w-100 py-3" for="qtype_{{ loop.index }}">{{ qtype }}</label>
            </div>
          {% endfor %}
        </div>
      </div>

      <div class="mb-3">
        <label for="page_range" class="form-label">PDFì¸ ê²½ìš° í˜ì´ì§€ ë²”ìœ„ (ì˜ˆ: 1-5)</label>
        <input
          type="text"
          class="form-control"
          id="page_range"
          name="page_range">
      </div>

      <div class="mb-3">
        <label for="requirements" class="form-label">ì¶”ê°€ ìš”êµ¬ì‚¬í•­</label>
        <textarea
          class="form-control"
          id="requirements"
          name="requirements"
          rows="4"
          placeholder="ì˜ˆì‹œ:&#10;- íŠ¹ì • ì£¼ì œì— ëŒ€í•´ ë” ë§ì€ ë¬¸ì œë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”&#10;- ë¬¸ì œì— ì‹¤ìƒí™œ ì˜ˆì‹œë¥¼ í¬í•¨í•´ì£¼ì„¸ìš”&#10;- ì–´ë ¤ìš´ ìš©ì–´ëŠ” ì‰¬ìš´ ì„¤ëª…ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”"></textarea>
      </div>

      <div class="mb-3">
        <label for="custom_prompt" class="form-label">ë‚´ê°€ ì›í•˜ëŠ” ë¬¸ì œ ì¡°ê±´/ìŠ¤íƒ€ì¼/ìœ í˜• (ììœ  í”„ë¡¬í”„íŠ¸)</label>
        <textarea
          class="form-control"
          id="custom_prompt"
          name="custom_prompt"
          rows="3"
          placeholder="ì˜ˆ: ëª¨ë“  ë¬¸ì œë¥¼ OXí˜•ìœ¼ë¡œ, ì‹¤ìƒí™œ ì˜ˆì‹œ í¬í•¨, íŠ¹ì • ë‹¨ì–´ ë°˜ë“œì‹œ í¬í•¨ ë“±"></textarea>
      </div>
    </div>
  </div>

  <div class="text-center">
    <button type="submit" class="btn btn-primary btn-lg px-5">ğŸš€ ë¬¸ì œ ìƒì„±í•˜ê¸°</button>
  </div>
</form>

<!-- ìŠ¤í¬ë¦½íŠ¸: showLoading í•¨ìˆ˜ -->
<script>
  function showLoading() {
    const overlay = document.getElementById('loadingOverlay');
    if (overlay) {
      overlay.style.display = 'flex';
    }
  }
</script>