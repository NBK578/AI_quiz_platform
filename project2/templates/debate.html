{% extends "base.html" %}
{% block title %}AI 토론 시뮬레이터{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="mb-4 text-center">🧠 AI 토론 시뮬레이터</h1>

    {% if mode == 'gpt_vs_gpt' %}
    <form method="post" class="mb-5">
        <div class="mb-3">
            <label for="topic" class="form-label">토론 주제</label>
            <input type="text" class="form-control" name="topic" required>
        </div>
        <div class="mb-3">
            <label for="round_count" class="form-label">라운드 수</label>
            <input type="number" class="form-control" name="round_count" value="3" min="1" max="10" required>
        </div>
        <button type="submit" class="btn btn-primary">토론 시작</button>
    </form>

    {% if result %}
    <div class="card p-4 mb-4">
        <h3 class="mb-3">주제: {{ result.topic }}</h3>
        {% for round in result.rounds %}
        <h5>Round {{ loop.index }}</h5>
        <p><strong>찬성:</strong> {{ round.pro }}</p>
        <p><strong>반대:</strong> {{ round.con }}</p>
        <hr>
        {% endfor %}

        {% for strat in result.strategies %}
        <p><strong>💡 전략 (찬성):</strong> {{ strat.pro }}</p>
        <p><strong>💡 전략 (반대):</strong> {{ strat.con }}</p>
        <hr>
        {% endfor %}

        <p><strong>📝 요약:</strong> {{ result.summary }}</p>
    </div>
    {% endif %}

    {% elif mode == 'user_vs_gpt' %}
    <form method="post" class="mb-5">
        <div class="mb-3">
            <label for="topic" class="form-label">토론 주제</label>
            <input type="text" class="form-control" name="topic" required>
        </div>
        <div class="mb-3">
            <label for="user_statement" class="form-label">당신의 주장</label>
            <textarea class="form-control" name="user_statement" rows="4" required></textarea>
        </div>
        <button type="submit" class="btn btn-success">GPT 반박 듣기</button>
    </form>

    {% if gpt_response %}
    <div class="card p-4 bg-light">
        <h5>🧑 사용자 주장</h5>
        <p>{{ user_statement }}</p>
        <h5 class="mt-3">🤖 GPT 반박</h5>
        <p>{{ gpt_response }}</p>
    </div>
    {% endif %}
    {% endif %}
</div>
{% endblock %}
